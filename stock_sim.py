import numpy as np;
import random;
# from random import random;

class Stock:
	def __init__ (self, price, horizon):
		self.price = price;
		self.horizon = horizon;
		self.increments = [-1,1];

	def sim_path (self):
		path = np.zeros((1+self.horizon));
		path[0] = self.price;
		increments = [random.choice(self.increments) for inc in range(self.horizon)];
		path[1:] = self.price + np.cumsum(increments);

		return path;

s1 = Stock(price=100, horizon=10);
path = s1.sim_path();

print(path);


num_paths = 100;
out_of_range = 0;
lower_bound = 97;
upper_bound = 102;

verbose = True;

for ix in range(num_paths):
	path_i = s1.sim_path();
	val_term = path_i[-1];
	if (val_term < lower_bound) or (val_term > upper_bound):
		out_of_range += 1;
	if (verbose):
		print({'path':path, 'val':val_term, 'out_of_range':out_of_range});


prob = out_of_range / num_paths;

print('Prob that stock outside range [', lower_bound, ', ', upper_bound, ']: ', prob);



#
# Output
#


# (base) thammons@toms-MacBook-Air reinforcement_learning % python3 stock_sim.py
#
# [100. 101. 102. 101. 102. 101. 100.  99.  98.  99.  98.]
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 1}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 1}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 1}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 2}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 3}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 3}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 3}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 3}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 4}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 4}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 4}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 4}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 4}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 5}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 5}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 5}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 5}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 6}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 6}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 6}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 6}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 7}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 106.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 8}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 9}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 10}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 11}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 11}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 12}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 12}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 94.0, 'out_of_range': 13}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 13}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 14}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 15}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 15}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 15}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 15}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 15}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 92.0, 'out_of_range': 16}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 16}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 16}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 16}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 17}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 17}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 17}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 94.0, 'out_of_range': 18}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 18}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 92.0, 'out_of_range': 19}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 19}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 19}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 19}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 20}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 94.0, 'out_of_range': 21}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 21}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 21}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 22}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 94.0, 'out_of_range': 23}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 24}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 24}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 25}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 94.0, 'out_of_range': 26}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 27}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 27}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 27}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 108.0, 'out_of_range': 28}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 28}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 28}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 28}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 28}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 104.0, 'out_of_range': 29}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 96.0, 'out_of_range': 30}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 108.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 102.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 98.0, 'out_of_range': 31}
# {'path': array([100., 101., 102., 101., 102., 101., 100.,  99.,  98.,  99.,  98.]), 'val': 100.0, 'out_of_range': 31}
# Prob that stock outside range [ 97 ,  102 ]:  0.31